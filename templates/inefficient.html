{% extends "base.html" %}
{% block content %}
    <h2>Inefficient Routes</h2>

    {% if files %}
        <h4>Select a file to view inefficient routes:</h4>
        <div class="list-group">
            {% for file in files %}
                <a href="{{ url_for('show_inefficient', file_id=file.id) }}"
                   class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                    {{ file.filename }}
                    <span class="badge bg-primary rounded-pill">{{ file.upload_date.strftime('%Y-%m-%d') }}</span>
                </a>
            {% endfor %}
        </div>

    {% elif routes %}
        <h4>
            Inefficient Routes for “{{ selected_file.filename }}”
            <small class="text-muted">(File ID {{ selected_file.id }})</small>
        </h4>

        <table class="table table-striped">
            <thead>
            <tr>
                <th>File ID</th>
                <th>Base Address</th>
                <th>Shipping Address</th>
                <th>Starting Time</th>
                <th>Expected Delivery Time</th>
                <th>Actual Delivery Time</th>
                <th>Delay (hrs)</th>
                <th>Expected Cost (VND)</th>
                <th>Actual Cost (VND)</th>
                <th>Max Cost (VND/hr)</th>
                <th>Optimized Delivery Time (hrs)</th>
                <th>Time Saved (hrs)</th>
            </tr>
            </thead>
            <tbody>
            {% for r in routes %}
                <tr>
                    <td>{{ r.file_id }}</td>
                    <td>{{ r.base_address }}</td>
                    <td>{{ r.shipping_address }}</td>
                    <td>{{ r.starting_time }}</td>
                    <td>{{ r.expected_delivery_time }}</td>
                    <td>{{ r.actual_delivery_time }}</td>
                    <td>{{ r.delay_hours }}</td>
                    <td>{{ r.expected_delivery_cost }}</td>
                    <td>{{ r.actual_delivery_cost }}</td>
                    <td>{{ r.max_delivery_cost }}</td>
                    <td>{{ r.optimized_delivery_time }}</td>
                    <td>{{ r.time_saved }}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>

        <a href="{{ url_for('show_inefficient') }}" class="btn btn-secondary">Back to File Selection</a>

    {% else %}
        <p>No inefficient routes found.</p>
    {% endif %}
{% endblock %}
